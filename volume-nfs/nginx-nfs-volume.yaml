apiVersion: v1
kind: Namespace
metadata:
  name: ns-mynginx
---
apiVersion: v1
kind: Pod
metadata:
  name: pod-nginx-nfs
  labels:
    app: nfs-pod
  namespace: ns-mynginx
spec:
  nodeName: ubuntu22-server03
  containers:
  - name: ubuntu22-server-mynginx
    image: strrzj/ubuntu22-server-mynginx:latest
    imagePullPolicy: IfNotPresent
    resources:
      requests:
        memory: "64Mi"
        cpu: "200m"
      limits:
        memory: "64Mi"
        cpu: "200m"
    volumeMounts:
    - name: nginx-data
      mountPath: /etc/nginx/conf.d
      readOnly: true
  volumes:
  - name: nginx-data
    nfs:
      server: ubuntu22-server01    #nfs服务端IP
      path: /data/conf.d         #nfs服务端绑定目录
  restartPolicy: OnFailure
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: nfs-pod
  name: demonginx-nfs-volume
  namespace: ns-mynginx
spec:
  ports:
  - name: 80-80
    port: 80
    protocol: TCP
    targetPort: 80
  - name: 81-81
    port: 81
    protocol: TCP
    targetPort: 81
  externalIPs:
  - 192.168.198.150
  selector:
    app: nfs-pod
  type: NodePort
status:
  loadBalancer: {}
